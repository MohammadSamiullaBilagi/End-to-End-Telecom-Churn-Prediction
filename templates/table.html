<!doctype html>
<html lang="en" data-theme="light">
<head>
  <meta charset="utf-8">
  <title>Prediction Results</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">

  <style>
    /* Light theme */
    :root {
      --bg-color: #f8f9fa;
      --text-color: #212529;
      --card-bg: #ffffff;
      --muted-color: #6c757d;
      --input-bg: #ffffff;
      --border-color: #dee2e6;
      --btn-text: #ffffff;
      --btn-bg-success: #198754;
      --btn-bg-secondary: #6c757d;
      --table-row-alt: rgba(0,0,0,0.02);
    }

    /* Dark theme */
    [data-theme='dark'] {
      --bg-color: #0b1220;
      --text-color: #e6eef8;
      --card-bg: #071029;
      --muted-color: #9aa7b2;
      --input-bg: #0f1724;
      --border-color: #263241;
      --btn-text: #0b1220;
      --btn-bg-success: #16a34a;
      --btn-bg-secondary: #4b5563;
      --table-row-alt: rgba(255,255,255,0.02);
    }

    body {
      background-color: var(--bg-color) !important;
      color: var(--text-color) !important;
      transition: background 0.18s, color 0.18s;
    }

    .card {
      background-color: var(--card-bg) !important;
      border: 1px solid var(--border-color) !important;
      color: var(--text-color) !important;
    }

    h1,h2,h3,h4,h5,h6, label, .text-muted, small {
      color: var(--text-color) !important;
    }
    .text-muted { color: var(--muted-color) !important; }

    /* Buttons */
    .btn-success {
      background-color: var(--btn-bg-success) !important;
      color: var(--btn-text) !important;
      border-color: transparent !important;
    }
    .btn-secondary {
      background-color: var(--btn-bg-secondary) !important;
      color: var(--btn-text) !important;
      border-color: transparent !important;
    }

    /* ========================
       TABLE / pandas HTML fixes
       ======================== */
    table.dataframe, table, .dataframe {
      width: 100% !important;
      border-collapse: collapse !important;
      background: transparent !important;
      color: var(--text-color) !important;
      overflow: auto;
    }

    table.dataframe th,
    table.dataframe td,
    table th, table td,
    .dataframe th, .dataframe td {
      background: transparent !important;
      color: var(--text-color) !important;
      border: 1px solid var(--border-color) !important;
      padding: .45rem .6rem !important;
      vertical-align: top !important;
      white-space: nowrap;
    }

    table.dataframe th[style],
    table.dataframe td[style],
    .dataframe th[style],
    .dataframe td[style] {
      background: transparent !important;
      color: var(--text-color) !important;
    }

    thead th {
      font-weight: 600 !important;
      background: rgba(255,255,255,0.01) !important;
      text-align: left !important;
    }

    tbody tr:nth-child(even) {
      background: var(--table-row-alt) !important;
    }

    table.dataframe a, .dataframe a {
      color: var(--text-color) !important;
      text-decoration: underline !important;
    }

    .theme-toggle-btn {
      position: absolute;
      top: 20px;
      right: 30px;
      padding: 6px 15px;
      color: var(--text-color) !important;
      background: transparent !important;
      border: 1px solid var(--border-color) !important;
    }

    .high-contrast { color: var(--text-color) !important; }
  </style>
</head>

<body>

<button id="themeToggle" class="btn theme-toggle-btn" onclick="toggleTheme()">üåô Dark Mode</button>

<div class="container mt-4">
  <h3 class="high-contrast">Prediction Results</h3>

  <a href="{{ download_url }}" class="btn btn-success mb-3">Download CSV</a>

  <div class="card p-3">
    <!-- pandas-generated table_html (overridden by CSS above) -->
    {{ table_html | safe }}
  </div>

  <a href="{{ url_for('index') }}" class="btn btn-secondary mt-3">Upload Another File</a>
</div>

<!-- Theme Script -->
<script>
  function toggleTheme() {
    const html = document.documentElement;
    const current = html.getAttribute("data-theme");
    const newTheme = current === "light" ? "dark" : "light";
    html.setAttribute("data-theme", newTheme);
    localStorage.setItem("theme", newTheme);
    const btn = document.getElementById("themeToggle");
    if (btn) btn.textContent = newTheme === "light" ? "üåô Dark Mode" : "‚òÄÔ∏è Light Mode";
  }

  (function() {
    const saved = localStorage.getItem("theme") || "light";
    document.documentElement.setAttribute("data-theme", saved);
    const btn = document.getElementById("themeToggle");
    if (btn) btn.textContent = saved === "light" ? "üåô Dark Mode" : "‚òÄÔ∏è Light Mode";
  })();
</script>

</body>
</html>
